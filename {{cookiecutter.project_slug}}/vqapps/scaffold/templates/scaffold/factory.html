{% load scaffold %}
import factory
import factory.fuzzy

{% comment %}
{% for app, models in dependencies.items %}from {{app}}.factory import (
    {% for model in models %}{{model}}Factory,{% endfor %}
    )
{% endfor %}
{% endcomment %}

from {{app_label}}.models import (
    {% for model in models %}    {{model|get_model_classname}},
    {% endfor %})


{% for model in models %}
class {{model|get_model_classname}}Factory(factory.django.DjangoModelFactory):
    """
    Factory generated by VingtCinq Scaffolding toolbox
    """
{% for field in model|get_fields %}    {{field|get_factory_field|safe}}
{% endfor %}
    class Meta:
        model = {{model|get_model_classname}}

    {% for field in model|get_m2m_fields %}
    @factory.post_generation
    def {{field.name}}(self, create, extracted, **kwargs):
        if not create:
            # Simple build, do nothing.
            return

        if extracted:
            # A list of groups were passed in, use them
            for obj in extracted:
                self.{{field.name}}.add(obj)

    {% endfor %}


{% endfor %}